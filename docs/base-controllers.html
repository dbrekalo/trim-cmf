<!DOCTYPE html><html><head lang="en"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,minimal-ui"><meta name="theme-color" content="#ffffff"><title>Base controllers - Trim UI CMF</title><link rel="stylesheet" href="https://gitcdn.xyz/repo/dbrekalo/attire/master/dist/css/docsBuild.min.css"></head><body><header class="attireHeader"><h1 class="title">Trim UI CMF</h1><div class="attireSearch iconSearch"><input placeholder="Search documentation" type="text"></div></header><nav class="attireNav navType1"><button type="button" class="toggleBtn nBtn iconMenu">Toggle navigation</button><div class="panel"><div class="content"><a class="docLink" data-pointer="about#about" href="about#about">About</a><ul><li><a class="docLink" data-pointer="about#motivation" href="about#motivation">Motivation</a></li><li><a class="docLink" data-pointer="about#technology-and-tooling" href="about#technology-and-tooling">Technology and tooling</a></li><li><a class="docLink" data-pointer="about#code-sneek-peek" href="about#code-sneek-peek">Code sneek peek</a></li><li><a class="docLink" data-pointer="about#demo-application" href="about#demo-application">Demo application</a></li></ul><a class="docLink" data-pointer="getting-started#getting-started" href="getting-started#getting-started">Getting started</a><ul><li><a class="docLink" data-pointer="getting-started#technology" href="getting-started#technology">Technology</a></li><li><a class="docLink" data-pointer="getting-started#file-and-folder-structure" href="getting-started#file-and-folder-structure">File and folder structure</a></li><li><a class="docLink" data-pointer="getting-started#package-json" href="getting-started#package-json">Package.json</a></li><li><a class="docLink" data-pointer="getting-started#webpack-grunt-eslint" href="getting-started#webpack-grunt-eslint">Webpack, Grunt, Eslint</a></li><li><a class="docLink" data-pointer="getting-started#html-entry-point" href="getting-started#html-entry-point">HTML entry point</a></li><li><a class="docLink" data-pointer="getting-started#scss-setup" href="getting-started#scss-setup">SCSS setup</a></li><li><a class="docLink" data-pointer="getting-started#javascript-setup" href="getting-started#javascript-setup">Javascript setup</a></li><li><a class="docLink" data-pointer="getting-started#build-scripts" href="getting-started#build-scripts">Build scripts</a></li></ul><a class="docLink" data-pointer="core-concepts-and-api#core-concepts-and-api" href="core-concepts-and-api#core-concepts-and-api">Core concepts and api</a><ul><li><a class="docLink" data-pointer="core-concepts-and-api#resource-controller" href="core-concepts-and-api#resource-controller">Resource controller</a></li><li><a class="docLink" data-pointer="core-concepts-and-api#resource-list" href="core-concepts-and-api#resource-list">Resource list</a></li><li><a class="docLink" data-pointer="core-concepts-and-api#resource-edit" href="core-concepts-and-api#resource-edit">Resource edit</a></li><li><a class="docLink" data-pointer="core-concepts-and-api#services" href="core-concepts-and-api#services">Services</a></li><li><a class="docLink" data-pointer="core-concepts-and-api#router" href="core-concepts-and-api#router">Router</a></li><li><a class="docLink" data-pointer="core-concepts-and-api#navigation" href="core-concepts-and-api#navigation">Navigation</a></li><li><a class="docLink" data-pointer="core-concepts-and-api#application" href="core-concepts-and-api#application">Application</a></li></ul><a class="docLink" data-pointer="adding-resource#adding-resource" href="adding-resource#adding-resource">Adding resource</a><ul><li><a class="docLink" data-pointer="adding-resource#examine-resource-api" href="adding-resource#examine-resource-api">Examine resource api</a></li><li><a class="docLink" data-pointer="adding-resource#create-resource-controller" href="adding-resource#create-resource-controller">Create resource controller</a></li><li><a class="docLink" data-pointer="adding-resource#add-resource-route" href="adding-resource#add-resource-route">Add resource route</a></li><li><a class="docLink" data-pointer="adding-resource#add-navigation-item" href="adding-resource#add-navigation-item">Add navigation item</a></li><li><a class="docLink" data-pointer="adding-resource#register-controller-as-service" href="adding-resource#register-controller-as-service">Register controller as service</a></li></ul><a class="docLink" data-pointer="list-elements#list-elements" href="list-elements#list-elements">List elements</a><ul><li><a class="docLink" data-pointer="list-elements#shared-options" href="list-elements#shared-options">Shared options</a></li><li><a class="docLink" data-pointer="list-elements#text" href="list-elements#text">Text</a></li><li><a class="docLink" data-pointer="list-elements#link" href="list-elements#link">Link</a></li><li><a class="docLink" data-pointer="list-elements#date-time" href="list-elements#date-time">Date time</a></li><li><a class="docLink" data-pointer="list-elements#date" href="list-elements#date">Date</a></li><li><a class="docLink" data-pointer="list-elements#blip" href="list-elements#blip">Blip</a></li><li><a class="docLink" data-pointer="list-elements#button" href="list-elements#button">Button</a></li><li><a class="docLink" data-pointer="list-elements#context-menu" href="list-elements#context-menu">Context menu</a></li><li><a class="docLink" data-pointer="list-elements#media" href="list-elements#media">Media</a></li></ul><a class="docLink" data-pointer="form-elements#form-elements" href="form-elements#form-elements">Form elements</a><ul><li><a class="docLink" data-pointer="form-elements#shared-options" href="form-elements#shared-options">Shared options</a></li><li><a class="docLink" data-pointer="form-elements#common-methods" href="form-elements#common-methods">Common methods</a></li><li><a class="docLink" data-pointer="form-elements#text-input" href="form-elements#text-input">Text input</a></li><li><a class="docLink" data-pointer="form-elements#hidden-input" href="form-elements#hidden-input">Hidden input</a></li><li><a class="docLink" data-pointer="form-elements#textarea-input" href="form-elements#textarea-input">Textarea input</a></li><li><a class="docLink" data-pointer="form-elements#checkbox-input" href="form-elements#checkbox-input">Checkbox input</a></li><li><a class="docLink" data-pointer="form-elements#date-input" href="form-elements#date-input">Date input</a></li><li><a class="docLink" data-pointer="form-elements#date-time-input" href="form-elements#date-time-input">Date time input</a></li><li><a class="docLink" data-pointer="form-elements#html" href="form-elements#html">Html</a></li><li><a class="docLink" data-pointer="form-elements#map" href="form-elements#map">Map</a></li><li><a class="docLink" data-pointer="form-elements#select" href="form-elements#select">Select</a></li><li><a class="docLink" data-pointer="form-elements#multiple-select" href="form-elements#multiple-select">Multiple select</a></li><li><a class="docLink" data-pointer="form-elements#nested-select" href="form-elements#nested-select">Nested select</a></li><li><a class="docLink" data-pointer="form-elements#state-select" href="form-elements#state-select">State select</a></li><li><a class="docLink" data-pointer="form-elements#external-admin" href="form-elements#external-admin">External admin</a></li><li><a class="docLink" data-pointer="form-elements#included-admin" href="form-elements#included-admin">Included admin</a></li><li><a class="docLink" data-pointer="form-elements#media-preview" href="form-elements#media-preview">Media preview</a></li><li><a class="docLink" data-pointer="form-elements#media" href="form-elements#media">Media</a></li></ul><a class="docLink" data-pointer="base-controllers#base-controllers" href="base-controllers#base-controllers">Base controllers</a><ul><li><a class="docLink" data-pointer="base-controllers#resource-controller" href="base-controllers#resource-controller">Resource controller</a></li><li><a class="docLink" data-pointer="base-controllers#resource-edit-controller" href="base-controllers#resource-edit-controller">Resource edit controller</a></li><li><a class="docLink" data-pointer="base-controllers#nested-resource-controller" href="base-controllers#nested-resource-controller">Nested resource controller</a></li><li><a class="docLink" data-pointer="base-controllers#media-resource-controller" href="base-controllers#media-resource-controller">Media resource controller</a></li></ul></div></div></nav><article data-slug="base-controllers" class="attireArticle"><section id="section-base-controllers" class="attireBlock"><div class="inner"><h1 id="base-controllers" class="attireTitleType1">Base controllers</h1><p class="attireTextType2">Trim UI CMF includes a number of predefined UI base controllers for common use cases. Beside resource controller that is most frequently extended base controllers for resource edit, nested resource and media resource are available.</p></div></section><section id="section-resource-controller" class="attireBlock"><div class="inner"><h2 id="resource-controller" class="attireTitleType2">Resource controller</h2><p class="attireTextType2">Used when you need to define how resource is browsed, filtered and sorted in list, what form fields are rendered when resource is created or updated.</p><hr class="attireSeparator mod1"><p class="attireTextType2">Code example:</p><pre class="attireCodeHighlight"><code class="lang-js">var BaseResource = require('js/controllers/baseResource')

module.exports = BaseResource.extend({

    resourceName: 'tag',

    setupList: function(listHandler) {
        // how is resource listed?
    },

    setupEdit: function(editHandler, method, id) {
        // how is resource edited?
    }

});
</code></pre></div></section><section id="section-resource-edit-controller" class="attireBlock"><div class="inner"><h2 id="resource-edit-controller" class="attireTitleType2">Resource edit controller</h2><p class="attireTextType2">Used when you want to edit one specific resource and listing is not available. Implement "setupModel" method and provide model instance to edit. Visit demo application "My settings" interface to see this type of controller in action.</p><hr class="attireSeparator mod1"><p class="attireTextType2">Code example:</p><pre class="attireCodeHighlight"><code class="lang-js">var EntityModel = require('js/library/entity').Model;
var TextInput = require('js/formElements/text');

module.exports = require('js/controllers/baseResourceEdit').extend({

    setupModel: function(callback) {

        EntityModel.getFromApi({type: 'user', id: 1}, function(model) {
            callback.call(this, model);
        }, this);

    },

    setupEdit: function(editHandler) {

        this.setPageTitle('My settings');

        this.addSaveControl();

        editHandler.addField(TextInput, {
            label: 'Email',
            name: 'email',
            attributes: {
                input: {className: 'inputType2 size2'}
            }
        });

    }

});
</code></pre></div></section><section id="section-nested-resource-controller" class="attireBlock"><div class="inner"><h2 id="nested-resource-controller" class="attireTitleType2">Nested resource controller</h2><p class="attireTextType2">Used for hierarchal resources that can be presented in nested tree view form. Categories as resources usually have parent and child categories. Visit demo application category interface to see nested resource controller UI in action. Lets examine category api response:</p><pre class="attireCodeHighlight"><code class="lang-js">{
    type: 'category',
    id: '5',
    attributes: {
        title: 'Category 5',
        description: 'Aenean gravida, orci in sagittis tincidunt, dolor quam pellentesque dolor, nec viverra neque nunc id mi.',
        published: true
    },
    relationships: {
        parentCategory: {data: {id: '2', type: 'category'}},
        childCategories: {data: [
            {id: '7', type: 'category'}
        ]}
    }
}
</code></pre><p class="attireTextType2">Resource hierarchy is defined via parentCategory and childCategories relations.</p><hr class="attireSeparator mod1"><p class="attireTextType2">Our category resource controller should extend base nested resource controller. Via resourceConfig property we define parent and children relation mappings.</p><pre class="attireCodeHighlight"><code class="lang-js">var BaseNestedResource = require('js/controllers/baseNestedResource');

module.exports = BaseNestedResource.extend({

    resourceName: 'category',

    resourceConfig: {
        mapParentTo: 'parentCategory',
        mapChildrenTo: 'childCategories'
    },

    // list and edit api is defined like in any other controller
    ...
</code></pre><p class="attireTextType2">Resource config has following defaults:</p><pre class="attireCodeHighlight"><code class="lang-js">{
    mapParentTo: 'parent',
    mapChildrenTo: 'children',
    mapLevelTo: undefined,
    mapIsLeafTo: undefined,
    addNestedCreateControl: true
},
</code></pre><p class="attireTextType2">Properties mapChildrenTo, mapLevelTo, mapIsLeafTo can be defined as strings or functions if needed.</p></div></section><section id="section-media-resource-controller" class="attireBlock"><div class="inner"><h2 id="media-resource-controller" class="attireTitleType2">Media resource controller</h2><p class="attireTextType2">Used for browse, create (upload) and edit media resources sush as images or files. Visit demo application media interface to see media resource controller UI in action. Lets examine typical media api response:</p><pre class="attireCodeHighlight"><code class="lang-js">{
    type: 'media',
    id: '1',
    attributes: {
        title: 'Media item 1',
        caption: 'Aenean gravida, orci in sagittis tincidunt, dolor quam pellentesque dolor, nec viverra neque nunc id mi.',
        mediaType: 'image',
        thumbnailUrl: 'http://pipsum.com/400x300.jpg?v=' + String(index),
        originalUrl: 'http://pipsum.com/1200x900.jpg?v=' + String(index)
    }
}
</code></pre><p class="attireTextType2">Example media controller is shown bellow. Via resource config propery we define list of media types (image, file, videoEmbed) our controller is handling. For each media type a method for edit handling is defined (setup[MediaType]Edit).</p><pre class="attireCodeHighlight"><code class="lang-js">module.exports = require('js/controllers/baseMediaResource').extend({

    resourceName: 'media',

    resourceConfig: {
        mediaTypes: ['image', 'file', {
            name: 'videoEmbed',
            createPageTitle: 'Create video embed',
            hasUploadUi: false
        }]
    },

    setupList: function(listHandler) {

        this.addControl({
            caption: 'Upload new image',
            className: 'accented iconPlus',
            action: this.createImage // we point action to create[MediaType] method
        }).addDropdownControl({
            caption: 'Add media',
            className: 'accented icr iconArrowDown',
            items: [{
                caption: 'Create video embed',
                action: this.createVideoEmbed
            }, {
                caption: 'Upload file',
                action: this.createFile
            }]
        });

        ...

    },

    setupImageEdit: function(editHandler, method, id) {

        this.addToIndexControl().addSaveControl();

        editHandler.addField(MediaPreview, {
            label: 'Photography',
            name: 'mediaPreview'
        });

        ...

    },

    setupVideoEmbedEdit: function(editHandler) {

        ...

    },

    setupFileEdit: function(editHandler) {

        ...

    }

});
</code></pre><p class="attireTextType2">Resource config has following defaults:</p><pre class="attireCodeHighlight"><code class="lang-js">resourceConfig: {
    mapMediaTypeTo: 'mediaType',
    mediaTypes: ['image'],
    uploadUrl: function() {
        return router.apiUrl(this.resourceName) + '/upload';
    },
    prepareModelFromUpload: function(file, response, callback) {
        EntityModel.getFromApi({url: file.xhr.getResponseHeader('Location')}, callback, this);
    },
    fileUploadParamName: 'binary',
    fileUploadHeaders: null
}
</code></pre><p class="attireTextType2">For our media controller to work properly we have to define following routes:</p><pre class="attireCodeHighlight"><code class="lang-js">router.route('media/create-image', 'resource.media.createImage', {uses: 'Media@createImage'});
router.route('media/create-video-embed', 'resource.media.createVideoEmbed', {uses: 'Media@createVideoEmbed'});
router.route('media/create-file', 'resource.media.createFile', {uses: 'Media@createFile'});
router.route('media/:id', 'resource.media.edit', {uses: 'Media@edit'});
router.route('media', 'resource.media.index', {uses: 'Media@index'});
</code></pre></div></section></article><footer class="attireFooter"><p>This page is built with <a href="http://dbrekalo.github.io/attire/">Attire</a>.</p></footer><a class="githubRibbon" href="https://github.com/trikoder/trim"><img src="https://gitcdn.xyz/repo/dbrekalo/attire/master/dist/images/githubRibbon.png" alt="Fork me on GitHub"></a><script src="https://gitcdn.xyz/repo/dbrekalo/attire/master/dist/js/docsBuild.min.js"></script></body></html>